<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>SystemVerilog学习（一） - Wenhui&#39;s Rotten Pen</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="文辉" />
  <meta name="description" content="本文 SystemVerilog学习系列主要介绍SystemVerilog语言的基础知识，是验证工程师必须熟练掌握的语言基础。此为第一篇，主要" />

  <meta name="keywords" content="Hugo, linux, emacs, CPU" />






<meta name="generator" content="Hugo 0.58.3" />


<link rel="canonical" href="https://wenhui.space/post/digital_verifer/study_systemverilog_one/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.0995afa14b62cd93e93cfc066b646c4c17a3eddca0e9d52a1d9dcf5d90aaacd3.css" integrity="sha256-CZWvoUtizZPpPPwGa2RsTBej7dyg6dUqHZ3PXZCqrNM=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="SystemVerilog学习（一）" />
<meta property="og:description" content="本文 SystemVerilog学习系列主要介绍SystemVerilog语言的基础知识，是验证工程师必须熟练掌握的语言基础。此为第一篇，主要" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://wenhui.space/post/digital_verifer/study_systemverilog_one/" />
<meta property="article:published_time" content="2020-01-08T22:17:00+08:00" />
<meta property="article:modified_time" content="2020-03-01T08:45:18+08:00" />
<meta itemprop="name" content="SystemVerilog学习（一）">
<meta itemprop="description" content="本文 SystemVerilog学习系列主要介绍SystemVerilog语言的基础知识，是验证工程师必须熟练掌握的语言基础。此为第一篇，主要">


<meta itemprop="datePublished" content="2020-01-08T22:17:00&#43;08:00" />
<meta itemprop="dateModified" content="2020-03-01T08:45:18&#43;08:00" />
<meta itemprop="wordCount" content="5392">



<meta itemprop="keywords" content="SystemVerilog," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="SystemVerilog学习（一）"/>
<meta name="twitter:description" content="本文 SystemVerilog学习系列主要介绍SystemVerilog语言的基础知识，是验证工程师必须熟练掌握的语言基础。此为第一篇，主要"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">文辉的烂笔头</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://wenhui.space/">主页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://wenhui.space/post/">归档</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://wenhui.space/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://wenhui.space/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://wenhui.space/about/">关于</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://wenhui.space/links/">友链</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://wenhui.space/index.xml">订阅</a>
          
        
      </li>
    

    
  </ul>
</nav>


  
    






  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.min.css" integrity="sha256-LWdHSKWG7zv3DTpee8YAgoTfkj3gNkfauF624h4P2Nw=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/default-skin/default-skin.min.css" integrity="sha256-Q9bBMw/rHRRag46GDWY84J3elDNc8JJjKXL9tIC4oe8=" crossorigin="anonymous" />




<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>

  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      文辉的烂笔头
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://wenhui.space/">主页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://wenhui.space/post/">归档</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://wenhui.space/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://wenhui.space/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://wenhui.space/about/">关于</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://wenhui.space/links/">友链</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://wenhui.space/index.xml">订阅</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">SystemVerilog学习（一）</h1>
      
      <div class="post-meta">
        <time datetime="2020-01-08" class="post-time">
          2020-01-08
        </time>
        <div class="post-category">
            <a href="https://wenhui.space/categories/%E8%8A%AF%E7%89%87%E9%AA%8C%E8%AF%81%E5%B7%A5%E7%A8%8B%E5%B8%88/"> 芯片验证工程师 </a>
            
          </div>
        <span class="more-meta"> 约 5392 字 </span>
          <span class="more-meta"> 预计阅读 11 分钟 </span>

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#本文">本文</a></li>
<li><a href="#参考">参考</a></li>
<li><a href="#概览">概览</a></li>
<li><a href="#数据类型">数据类型</a>
<ul>
<li><a href="#內建数据类型">內建数据类型</a></li>
<li><a href="#定宽数组">定宽数组</a>
<ul>
<li><a href="#数组声明-变量左侧为矢量宽度-右侧为维度-且从左至右代表维度从高到低">数组声明（变量左侧为矢量宽度，右侧为维度，且从左至右代表维度从高到低）：</a></li>
<li><a href="#数组的初始化和赋值">数组的初始化和赋值：</a></li>
<li><a href="#存储空间考量">存储空间考量：</a></li>
<li><a href="#数组操作之for和foreach循环">数组操作之for和foreach循环：</a></li>
</ul></li>
<li><a href="#动态数组">动态数组</a></li>
<li><a href="#队列">队列</a></li>
<li><a href="#关联数组">关联数组</a></li>
<li><a href="#结构体">结构体</a></li>
<li><a href="#枚举类型">枚举类型</a></li>
<li><a href="#字符串">字符串</a></li>
</ul></li>
<li><a href="#过程块和方法">过程块和方法</a>
<ul>
<li><a href="#initial和always">initial和always</a></li>
<li><a href="#函数function">函数function</a></li>
<li><a href="#任务task">任务task</a></li>
<li><a href="#变量的生命周期">变量的生命周期</a></li>
</ul></li>
<li><a href="#设计例化和连接">设计例化和连接</a>
<ul>
<li><a href="#模块定义">模块定义</a></li>
<li><a href="#模块例化">模块例化</a></li>
<li><a href="#模块连接">模块连接</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      

<h2 id="本文">本文</h2>

<p>SystemVerilog学习系列主要介绍SystemVerilog语言的基础知识，是验证工程师必须熟练掌握的语言基础。此为第一篇，主要介绍数据类型、过程块和方法、设计例化和连接。</p>

<table>
<thead>
<tr>
<th>版本</th>
<th>说明</th>
</tr>
</thead>

<tbody>
<tr>
<td>0.1</td>
<td>初版发布</td>
</tr>
</tbody>
</table>

<h2 id="参考">参考</h2>

<ul>
<li>《SystemVerilog验证》，也就是所谓的绿皮书。</li>
<li>路科验证。</li>
</ul>

<h2 id="概览">概览</h2>

<p><center>
<img width="800" src="/image/digital-verifer/Study-SystemVerilog-One.png">
<div style="color:darkorange;"> <b>  </b>  </div>
</center></p>

<h2 id="数据类型">数据类型</h2>

<p>写在前面：SystemVerilog完全兼容Verilog语言</p>

<h3 id="內建数据类型">內建数据类型</h3>

<p>verilog中数据类型区分寄存器型（register）和线网型（net），分别用reg和wire去声明，而sv中并不区分reg和wire，而是引用新的数据类型logic（sv中也可以使用reg和wire，不过并不建议这样做）。</p>

<p>除了logic，还有bit数据类型，它们默认都代表一位数据，也就是它们都可以构建矢量类型（logic/bit [7:0] signal_name）。其区别之处为：</p>

<ul>
<li>logic为四值逻辑： 0 1 X Z，四值逻辑类型还包括 integer、 reg、 wire。</li>
<li>bit为二值逻辑： 0 1（引入二值逻辑其目的是将验证软件化），二值逻辑类型还包括 byte、 shortint、int、longint。</li>
</ul>

<p>数据类型除了二值四值之分，还存在有符号无符号之分：</p>

<ul>
<li>有符号：byte、shortint、int、longint、integer</li>
<li>无符号：bit、logic、reg、wire</li>
</ul>

<p>关于数据类型的几个注意点：</p>

<ul>
<li>尽量避免两种不同数据类型变量进行操作，包括有无符号，四值二值，不同位宽，如必须进行操作，请先转换为同一类型。</li>
<li>四值变量的x和z态转换为二值变量的0（不过尽量避免四值和二值变量的转换）</li>
<li>多位数据赋值给少位数据，高位被截取忽略；少位数据赋值给多位数据，二值类型的话高位赋值为0，四值类型的话高位赋值为x（如果是有符号类型，高位赋符号位，不过尽量避免不同位宽数据赋值）。</li>
<li>有符号变量转无符号变量，直接赋值的话会将原始比特数据赋给无符号变量，但其原符号位失去含义；使用转换语句转换的话，会将有符号变量取模赋值给无符号变量（不过尽量避免有无符号数据之间转换）</li>
</ul>

<p>数据类型转换（待补充）：</p>

<ul>
<li>静态转换（不对转换值进行检查）：</li>
</ul>

<!--listend-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="n">unsigned_data</span> <span class="o">=</span> <span class="k">unsigned</span><span class="p">&#39;(</span><span class="n">signed_data</span><span class="p">);</span>
<span class="n">int_data</span> <span class="o">=</span> <span class="kt">int</span><span class="p">&#39;(</span><span class="n">real_data</span><span class="p">);</span>
<span class="n">real_data</span> <span class="o">=</span> <span class="kt">real</span><span class="p">&#39;(</span><span class="n">int_data</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div>
<ul>
<li>动态转换（仿真时对转换值进行检查，并输出检查和转换结果）：</li>
</ul>

<!--listend-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="c1">//$cast(tgt,src);
</span><span class="c1"></span><span class="n">$cast</span><span class="p">(</span><span class="n">unsigned_data</span><span class="p">,</span><span class="n">signed_data</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div>
<h3 id="定宽数组">定宽数组</h3>

<h4 id="数组声明-变量左侧为矢量宽度-右侧为维度-且从左至右代表维度从高到低">数组声明（变量左侧为矢量宽度，右侧为维度，且从左至右代表维度从高到低）：</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="c1">//二维数组（习惯上左右顺序是从低到高，这对初始化很重要）
</span><span class="c1"></span><span class="kt">int</span> <span class="n">data_a</span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="mh">15</span><span class="p">];</span>          <span class="c1">// 16个整数[0]...[15]
</span><span class="c1"></span><span class="kt">int</span> <span class="n">data_a</span><span class="p">[</span><span class="mh">16</span><span class="p">];</span>            <span class="c1">// 紧凑型声明
</span><span class="c1"></span>
<span class="c1">//多维数组（左边为高维度）
</span><span class="c1"></span><span class="kt">int</span> <span class="n">data_a</span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="mh">7</span><span class="p">]</span> <span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="mh">3</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">data_a</span><span class="p">[</span><span class="mh">7</span><span class="p">]</span> <span class="p">[</span><span class="mh">3</span><span class="p">];</span>        <span class="c1">// 紧凑的多维数组声明
</span><span class="c1"></span><span class="kt">int</span> <span class="n">data_a</span><span class="p">[</span><span class="mh">7</span><span class="p">][</span><span class="mh">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>     <span class="c1">// 为最后一个元素赋值
</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="数组的初始化和赋值">数组的初始化和赋值：</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="kt">int</span> <span class="n">data_a</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">&#39;{</span><span class="mh">0</span><span class="p">,</span><span class="mh">1</span><span class="p">,</span><span class="mh">2</span><span class="p">,</span><span class="mh">3</span><span class="p">};</span>     <span class="c1">//data_a[0]为0 ... data_a[3]为3
</span><span class="c1"></span><span class="kt">int</span> <span class="n">data_a</span><span class="p">[</span><span class="mh">0</span><span class="o">:</span><span class="mh">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">&#39;{</span><span class="mh">0</span><span class="p">,</span><span class="mh">1</span><span class="p">,</span><span class="mh">2</span><span class="p">,</span><span class="mh">3</span><span class="p">};</span>   <span class="c1">//data_a[0]为0 ... data_a[3]为3
</span><span class="c1"></span><span class="kt">int</span> <span class="n">data_a</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">&#39;{</span><span class="mh">4</span><span class="p">{</span><span class="mh">1</span><span class="p">}};</span>        <span class="c1">//全赋值为1
</span><span class="c1"></span><span class="kt">int</span> <span class="n">data_a</span><span class="p">[</span><span class="mh">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">&#39;{</span><span class="mh">5</span><span class="p">,</span><span class="k">default</span><span class="o">:-</span><span class="mh">1</span><span class="p">};</span> <span class="c1">//data_a[0]为5，其他为-1
</span></code></pre></td></tr></table>
</div>
</div>
<h4 id="存储空间考量">存储空间考量：</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="kt">bit</span> <span class="p">[</span><span class="mh">3</span><span class="p">][</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">b_pack</span><span class="p">;</span>
<span class="kt">bit</span> <span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">b_unpack</span> <span class="p">[</span><span class="mh">3</span><span class="p">];</span>
<span class="kt">logic</span> <span class="p">[</span><span class="mh">3</span><span class="p">][</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">b_pack</span><span class="p">;</span>
<span class="kt">logic</span> <span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">b_unpack</span> <span class="p">[</span><span class="mh">3</span><span class="p">];</span>
</code></pre></td></tr></table>
</div>
</div>
<p>一般变量左侧的宽度代表矢量宽度，右侧代表数组维度，也可以称为数组的合并与非合并，以上都可以代表24bit数据容量。二值逻辑bit声明，每bit位占用1bit空间，第一种声明占用1WORD空间，3x8bit，第二种声明占用3个WORD空间，3WORD x 1x8bit；四值逻辑logic声明，每bit位占用2bit空间，第一种声明占用2WORD空间，3x16bit，第二种声明占用3WORD空间，3WORD x 1x16bit。所以，在合适的时候选用合并数组，能够节省存储空间。（软件仿真时计算机空间占用都是以word为单位的）</p>

<h4 id="数组操作之for和foreach循环">数组操作之for和foreach循环：</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="kt">bit</span> <span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">src</span><span class="p">[</span><span class="mh">5</span><span class="p">];</span>
<span class="kt">bit</span> <span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">dst</span><span class="p">[</span><span class="mh">5</span><span class="p">];</span>

<span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mh">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">$size</span><span class="p">(</span><span class="n">src</span><span class="p">);</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="n">src</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>

<span class="n">foreach</span> <span class="p">(</span><span class="n">dst</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
    <span class="n">dst</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">src</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="mh">2</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div>
<p>$size(src)是获取最高维度变量个数，也可以指定维度$size(src，1)，其中1代表最高，2次之&hellip; foreach语句会遍历数组变量，这也是最推荐的使用方法，多维度遍历可以使用foreach(dst[i,j])。</p>

<ul>
<li>数组操作之复制和比较：</li>
</ul>

<p>赋值可以直接使用赋值符号“=”，直接进行数组的复制；对于比较，也可以使用“==”或“！=”来比较，不过结果仅限于内容相同或不相同。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="kt">bit</span> <span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">src</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">&#39;{</span><span class="mh">0</span><span class="p">,</span><span class="mh">1</span><span class="p">,</span><span class="mh">2</span><span class="p">,</span><span class="mh">3</span><span class="p">,</span><span class="mh">4</span><span class="p">};</span>
<span class="kt">bit</span> <span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">dst</span><span class="p">[</span><span class="mh">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">&#39;{</span><span class="mh">4</span><span class="p">,</span><span class="mh">3</span><span class="p">,</span><span class="mh">2</span><span class="p">,</span><span class="mh">1</span><span class="p">,</span><span class="mh">0</span><span class="p">};</span>
<span class="k">if</span><span class="p">(</span><span class="n">src</span> <span class="o">==</span> <span class="n">dst</span><span class="p">)</span> <span class="nb">$display</span><span class="p">(</span><span class="s">&#34;src == dst&#34;</span><span class="p">);</span> <span class="c1">//比较数组
</span><span class="c1"></span>
<span class="n">dst</span> <span class="o">=</span> <span class="n">src</span><span class="p">;</span> <span class="c1">//数组复制
</span><span class="c1"></span>
<span class="n">src</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">5</span><span class="p">;</span> <span class="c1">//修改数组中某元素
</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="动态数组">动态数组</h3>

<ul>
<li>定宽数组类型宽度编译时已经确定，若在程序运行时在确定数组宽度就要使用 <strong>动态数组</strong> 。</li>
<li>动态数组特点就是仿真运行时灵活调节数组的大小，也就是存储量。</li>
<li>动态数组开始时使用“[]”来声明，此时数组为空，其后使用“new[]”来分配空间，方括号中传递数组宽度。</li>
<li>调用“new[]”时也可以将数组名一并传递，将已有数组的值复制到新的数组中。</li>
</ul>

<!--listend-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="kt">int</span> <span class="n">dyn</span><span class="p">[];</span>
<span class="kt">int</span> <span class="n">d2</span><span class="p">[];</span> <span class="c1">//声明动态数组
</span><span class="c1"></span>
<span class="k">initial</span> <span class="k">begin</span>
    <span class="n">dyn</span> <span class="o">=</span> <span class="n">new</span><span class="p">[</span><span class="mh">5</span><span class="p">];</span> <span class="c1">//分配5个元素
</span><span class="c1"></span>
    <span class="n">foreach</span><span class="p">(</span><span class="n">dyn</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="n">dyn</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span> <span class="c1">//对元素初始化
</span><span class="c1"></span>
    <span class="n">d2</span> <span class="o">=</span> <span class="n">dyn</span><span class="p">;</span> <span class="c1">//复制动态数组，d2初始元素个数为零，复制后元素个数为5，且dyn和d2各自独立
</span><span class="c1"></span>    <span class="n">d2</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">5</span><span class="p">;</span> <span class="c1">//修改元素值，此时dyn[0]仍为0，d2[0]为5
</span><span class="c1"></span>
    <span class="n">dyn</span> <span class="o">=</span> <span class="n">new</span><span class="p">[</span><span class="mh">20</span><span class="p">](</span><span class="n">dyn</span><span class="p">);</span> <span class="c1">//分配20个数值并进行复制，也就是dyn初始值5个元素复制给了新的dyn低5个元素，高15个元素为0.
</span><span class="c1"></span>    <span class="n">dyn</span> <span class="o">=</span> <span class="n">new</span><span class="p">[</span><span class="mh">100</span><span class="p">];</span> <span class="c1">//重新分配100个数值，而旧值不复存在
</span><span class="c1"></span>    <span class="n">dyn</span><span class="p">.</span><span class="n">delete</span><span class="p">();</span> <span class="c1">//删除所有元素
</span><span class="c1"></span><span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div>
<h3 id="队列">队列</h3>

<ul>
<li>队列结合了链表和数组的优点，可以在任何地方添加和删除元素，并且通过索引实现对任一元素的访问。</li>
<li>队列的声明是使用美元符号的下标：[$]，队列元素标号从0到$。</li>
<li>队列不需要new[]去创建空间，只需要使用队列的方法为其增减元素，队列初始空间为为零。</li>
<li>队列的简单使用是通过push_back()和pop_front()的结合来实现FIFIO的用法。</li>
</ul>

<!--listend-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">q2</span><span class="p">[</span><span class="err">$</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">3</span><span class="p">,</span><span class="mh">4</span><span class="p">};</span>
<span class="kt">int</span> <span class="n">q</span><span class="p">[</span><span class="err">$</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="mh">0</span><span class="p">,</span><span class="mh">2</span><span class="p">,</span><span class="mh">5</span><span class="p">};</span> <span class="c1">//队列的赋值不需要单引号
</span><span class="c1"></span>
<span class="k">initial</span> <span class="k">begin</span>
    <span class="n">q</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mh">1</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span> <span class="c1">//{0,1,2,5} 在1位置插入1
</span><span class="c1"></span>    <span class="n">q</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="mh">3</span><span class="p">,</span> <span class="n">q2</span><span class="p">);</span> <span class="c1">//{0,1,2,3,4,5} 在队列q 3位置中插入队列q2
</span><span class="c1"></span>    <span class="n">q</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="mh">1</span><span class="p">);</span> <span class="c1">//{0,2,3,4,5} 删除队列中1位置元素
</span><span class="c1"></span>
    <span class="c1">//下列操作才是队列中最常用方法
</span><span class="c1"></span>    <span class="n">q</span><span class="p">.</span><span class="n">push_front</span><span class="p">(</span><span class="mh">6</span><span class="p">);</span> <span class="c1">//{6,0,2,3,4,5} 在队列头部插入
</span><span class="c1"></span>    <span class="n">j</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">pop_back</span><span class="p">();</span> <span class="c1">//{6,0,2,3,4} 在队列尾部弹出
</span><span class="c1"></span>    <span class="n">q</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="mh">8</span><span class="p">);</span> <span class="c1">//{6,0,2,3,4,8} 在队列尾部插入
</span><span class="c1"></span>    <span class="n">j</span> <span class="o">=</span> <span class="n">q</span><span class="p">.</span><span class="n">pop_front</span><span class="p">();</span> <span class="c1">//{0,2,3,4,8} 在队列头部弹出
</span><span class="c1"></span>
    <span class="n">foreach</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="nb">$display</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">j</span><span class="p">]);</span> <span class="c1">//打印整个队列
</span><span class="c1"></span>
    <span class="n">q</span><span class="p">.</span><span class="n">delete</span><span class="p">();</span> <span class="c1">//删除整个队列
</span><span class="c1"></span><span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div>
<h3 id="关联数组">关联数组</h3>

<ul>
<li>如果需要一个超大容量存储空间，而有相当部分数据不会被存储和访问，不管使用定宽数组还是动态数组，都会造成存储的浪费，这时候需要使用关联数组。</li>
<li>关联数组可以保存稀疏矩阵元素，当你对一个非常大的地址空间进行寻址时，该数组只为写入的元素分配空间，所以关联数组需要的空间远小于定宽或动态数组。</li>
<li>此外关联数组的灵活应用，在其他高级语言中都有类似的存储结构，比如Perl语言中称为哈希(Hash)，Python中称为词典(Dictionary)，可以灵活赋予key和value。</li>
</ul>

<!--listend-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="kt">bit</span> <span class="p">[</span><span class="mh">63</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">assoc</span><span class="p">[</span><span class="kt">int</span><span class="p">];</span> <span class="c1">//声明关联数组，关联数组中[]内声明数据类型，也就是index类型
</span><span class="c1"></span><span class="kt">int</span> <span class="n">idx</span> <span class="o">=</span> <span class="mh">1</span><span class="p">;</span>

<span class="k">repeat</span><span class="p">(</span><span class="mh">64</span><span class="p">)</span> <span class="k">begin</span> <span class="c1">//对稀疏分布的元素初始化
</span><span class="c1"></span>    <span class="n">assoc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">idx</span><span class="p">;</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">&lt;&lt;</span><span class="mh">1</span><span class="p">;</span> <span class="c1">//1 2 4 8 16 ......
</span><span class="c1"></span><span class="k">end</span>

<span class="n">foreach</span><span class="p">(</span><span class="n">assoc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="c1">//使用foreach变量关联数组，注意：并不一定按index大小顺序依次执行（可以使用sort排序）
</span><span class="c1"></span>    <span class="nb">$display</span><span class="p">(</span><span class="s">&#34;assoc[%d] = %h&#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">assoc</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>

<span class="c1">//找到并删除第一个元素，使用if(assoc.first(idx)) 可以判断数组是否为空
</span><span class="c1"></span><span class="n">assoc</span><span class="p">.</span><span class="n">first</span><span class="p">(</span><span class="n">idx</span><span class="p">);</span>
<span class="n">assoc</span><span class="p">.</span><span class="n">delete</span><span class="p">(</span><span class="n">idx</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div>
<h3 id="结构体">结构体</h3>

<ul>
<li>sv中可以使用struct语句创建结构，与c语言类似。</li>
<li>sv中struct功能较少，只可以定义一个数据的集合，也就是将若干相关变量组合到一个struct结构定义中。</li>
<li>通过使用typedef和struct，可以定义新的数据类型，并利于新的数据类型声明变量。</li>
</ul>

<!--listend-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="kt">bit</span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">r</span><span class="p">;</span>
    <span class="kt">bit</span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">g</span><span class="p">;</span>
    <span class="kt">bit</span><span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">b</span><span class="p">;</span>
<span class="p">}</span> <span class="n">pixel_str</span><span class="p">;</span> <span class="c1">//使用typedef和struct创建新的数据类型 pixel_str
</span><span class="c1"></span>
<span class="n">pixel_str</span> <span class="n">my_pixel</span><span class="p">;</span> <span class="c1">//使用新的数据类型声明变量
</span><span class="c1"></span><span class="n">my_pixel</span> <span class="o">=</span> <span class="p">&#39;{</span><span class="mh">8&#39;h10</span><span class="p">,</span> <span class="mh">8&#39;h20</span><span class="p">,</span> <span class="mh">8&#39;h30</span><span class="p">};</span> <span class="c1">//结构体赋值，此时赋值与声明时一一对应
</span><span class="c1"></span><span class="n">my_pixel</span> <span class="o">=</span> <span class="p">&#39;{</span><span class="nl">b:</span> <span class="mh">8&#39;h30</span><span class="p">,</span> <span class="nl">g:</span> <span class="mh">8&#39;h20</span><span class="p">,</span> <span class="nl">r:</span> <span class="mh">8&#39;h10</span><span class="p">};</span> <span class="c1">//结构体赋值，也可以指明结构体内赋值变量
</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="枚举类型">枚举类型</h3>

<ul>
<li>规范的操作码和指令有利于代码的编写和维护，如ADD、WRITE、IDEL等。</li>
<li>枚举类型enum经常和typedef搭配使用，由此便于用户自定义枚举类型的共享使用。</li>
<li>枚举类型保证一些非期望值的出现，增加代码可维护性和降低设计风险。</li>
</ul>

<!--listend-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="k">typedef</span> <span class="k">enum</span> <span class="p">{</span><span class="n">INIT</span><span class="p">,</span> <span class="n">DECODE</span><span class="p">,</span> <span class="n">IDLE</span><span class="p">}</span> <span class="n">fsmstate_e</span><span class="p">;</span> <span class="c1">//声明枚举类型和自定义数据类型
</span><span class="c1"></span><span class="n">fsmstate_e</span> <span class="n">pstate</span><span class="p">,</span> <span class="n">nstate</span><span class="p">;</span> <span class="c1">//通过自定义枚举数据类型 声明变量
</span><span class="c1"></span>
<span class="k">case</span><span class="p">(</span><span class="n">pstate</span><span class="p">)</span> <span class="c1">//枚举类型主要应用于状态机
</span><span class="c1"></span>    <span class="nl">IDEL:</span> <span class="n">nstate</span> <span class="o">=</span> <span class="n">INIT</span><span class="p">;</span>
    <span class="nl">INIT:</span> <span class="n">nstate</span> <span class="o">=</span> <span class="n">DECODE</span><span class="p">;</span>
    <span class="k">default</span><span class="o">:</span> <span class="n">nstate</span> <span class="o">=</span> <span class="n">IDLE</span><span class="p">;</span>
<span class="k">endcase</span>

<span class="nb">$display</span><span class="p">(</span><span class="s">&#34;Next state is %s&#34;</span><span class="p">,</span> <span class="n">nstate</span><span class="p">.</span><span class="n">name</span><span class="p">());</span> <span class="c1">//显示状态名
</span></code></pre></td></tr></table>
</div>
</div>
<h3 id="字符串">字符串</h3>

<ul>
<li>verilog语言中是不存在字符串的，而sv中添加了字符串string类型。</li>
<li>所有相关的字符串处理，都使用string来保存和处理。</li>
<li>字符串处理相关的格式化函数可以使用$sformatf()，如果只是打印输出，可以直接使用$display()。</li>
</ul>

<!--listend-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="k">string</span> <span class="n">s</span><span class="p">;</span> <span class="c1">//声明字符串，此时为空。
</span><span class="c1"></span>
<span class="k">initial</span> <span class="k">begin</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s">&#34;IEEE&#34;</span><span class="p">;</span>
    <span class="nb">$display</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">tolower</span><span class="p">());</span> <span class="c1">//显示 ieee (转小写)
</span><span class="c1"></span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&#34;-P1800&#34;</span><span class="p">);</span> <span class="c1">//字符串拼接， &#34;IEEE-P1800&#34;
</span><span class="c1"></span>
    <span class="nb">$display</span><span class="p">(</span><span class="s">&#34;@%t: %s&#34;</span><span class="p">,</span> <span class="nb">$time</span><span class="p">,</span> <span class="n">$sformatf</span><span class="p">(</span><span class="s">&#34;%s %d&#34;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="mh">42</span><span class="p">));</span> <span class="c1">//$sformatf返回字符串
</span><span class="c1"></span><span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div>
<h2 id="过程块和方法">过程块和方法</h2>

<h3 id="initial和always">initial和always</h3>

<ul>
<li>initial是不可综合的，为验证而生，always是可综合的，代表硬件电路。</li>
<li>module、interface可视为硬件域，program、class可视为软件域，区分硬件域和软件域对理解initial和always很有帮助。</li>
<li>always是为了描述硬件行为，可综合，使用时需要区分时序电路描述和组合电路描述。</li>
<li>initial是软件行为，只执行一次。</li>
<li>initial块和always块之间，以及不同initial块，不同always块，在仿真一开始都是同时执行的。</li>
<li>initial块内语句顺序执行的。</li>
<li>在verilog时代，所有的测试都放在initial块中，并且为了便于统一管理，建议放在同一个initial块中。</li>
<li>initial块可以放在module、interface和program中。</li>
<li>对于过程块，使用begin&hellip;end将其作用域包住，对于控制语句和循环语句，同样适用。</li>
</ul>

<h3 id="函数function">函数function</h3>

<ul>
<li>可以在参数列表指定输入参数(input)、输出参数(output)、输入输出参数(inout)或者引用参数(ref)。</li>
<li>可以有返回值，也可以无返回值(void)。</li>
</ul>

<!--listend-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="k">function</span> <span class="kt">int</span> <span class="n">double</span><span class="p">(</span><span class="k">input</span> <span class="n">a</span><span class="p">);</span>
    <span class="k">return</span> <span class="mh">2</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
<span class="k">endfunction</span>

<span class="k">initial</span> <span class="k">begin</span>
    <span class="nb">$display</span><span class="p">(</span><span class="s">&#34;double of %0d is %0d&#34;</span><span class="p">,</span> <span class="mh">10</span><span class="p">,</span> <span class="n">double</span><span class="p">(</span><span class="mh">10</span><span class="p">));</span>
<span class="k">end</span>
</code></pre></td></tr></table>
</div>
</div>
<p>函数其他属性：</p>

<ul>
<li>默认数据类型为logic。</li>
<li>数组可以作为形式参数传递。</li>
<li>function可以返回或不返回结果，返回结果需要使用关键字return，不返回需要声明为void function。</li>
<li>只有数据变量可以在形式参数列表被声明为ref类型，而线网类型则不能声明为ref类型。</li>
<li>使用ref时，有时为了保护参数对象只被读取不被修改，可以通过const的方式限定ref声明的参数。</li>
<li>在声明参数使，可以设置默认值（input a=10），同时如果在调用时省略参数的传递，则函数中使用默认值。</li>
</ul>

<h3 id="任务task">任务task</h3>

<p>任务相比函数更加灵活，且有以下不同点：</p>

<ul>
<li>task无法通过return返回结果，因此只能通过output、inout或ref的参数来返回。</li>
<li>task内可以使用耗时语句，而function不能。常见的耗时语句如：@event、wait event、#delay等。</li>
</ul>

<!--listend-->
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="k">task</span> <span class="n">double</span><span class="p">(</span><span class="k">output</span> <span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">b</span><span class="p">,</span> <span class="k">input</span> <span class="p">[</span><span class="mh">31</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">a</span><span class="p">);</span> <span class="c1">//不指明方向则默认为input
</span><span class="c1"></span>    <span class="n">b</span> <span class="o">=</span> <span class="mh">2</span><span class="o">*</span><span class="n">a</span><span class="p">;</span>
<span class="k">endtask</span>
</code></pre></td></tr></table>
</div>
</div>
<p>function和task的使用建议：</p>

<ul>
<li>初学者傻瓜式用法，可以全部采用task来定义方法，因为它可以内置耗时语句，也可不以内置耗时语句。</li>
<li>经验者要区分两种方法，非耗时方法使用function，耗时方法使用task，也就是function中完成纯粹的逻辑运算，而task更多完成需要耗时的信号采样或者驱动等场景。</li>
<li>调用function，在function和task内均可以调用其他function，而调用task，如果被调用task内使用了耗时语句，只能在task调用。</li>
</ul>

<h3 id="变量的生命周期">变量的生命周期</h3>

<ul>
<li>sv中数据的生命周期分为动态(automatic)和静态(static)。</li>
<li>局部变量的生命周期与其所在域共存亡，也就是在function/task中的临时变量，在其被调用结束后，临时变量的生命周期也将终结。</li>
<li>全局变量在程序执行开始到结束一直存在。</li>
<li>如果数据变量被声明为automatic，那么在进入该进程/方法后，automatic变量会被创建，离开该进程/方法后，automatic变量被销毁。而static在仿真开始时被创建，而在进程/方法执行过程中，不会被销毁，且可以被多个进程和方法所共享。</li>
<li>module内全部是静态变量，代表真实的电路结构。</li>
<li>对于automatic方法，其内部所有变量默认也是automatic。</li>
<li>对于static方法，其内部所有变量默认也是static。</li>
<li>对于static变量，声明时应该对齐做初始化，而初始化只会伴随它的生命周期执行一次，不会随着方法调用而多次初始化。</li>
<li>在module、program、interface声明的变量，以及其他在task/function之外声明的变量，默认是静态变量，存在于是整个仿真阶段。</li>
<li>也就是说，只要用户不注明automatic变量或方法，其变量就是static变量。</li>
</ul>

<h2 id="设计例化和连接">设计例化和连接</h2>

<h3 id="模块定义">模块定义</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="k">module</span> <span class="n">xprop</span> <span class="p">(</span>
<span class="c1">// Outputs
</span><span class="c1"></span><span class="n">out1</span><span class="p">,</span>
<span class="c1">// Inputs
</span><span class="c1"></span><span class="n">clk</span><span class="p">,</span> <span class="n">sel</span><span class="p">,</span> <span class="n">din0</span>
<span class="p">);</span>
<span class="k">input</span>       <span class="n">clk</span><span class="p">;</span>
<span class="k">input</span>       <span class="n">sel</span><span class="p">;</span>
<span class="k">input</span> <span class="p">[</span><span class="mh">7</span><span class="o">:</span><span class="mh">0</span><span class="p">]</span> <span class="n">din0</span><span class="p">;</span>

<span class="k">output</span>      <span class="n">out1</span><span class="p">;</span>

<span class="c1">//......
</span><span class="c1">//......
</span><span class="c1"></span>
<span class="k">endmodule</span>
</code></pre></td></tr></table>
</div>
</div>
<h3 id="模块例化">模块例化</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-verilog" data-lang="verilog"><span class="k">module</span> <span class="n">testbench</span><span class="p">;</span>
<span class="c1">//......
</span><span class="c1">//......
</span><span class="c1"></span>
    <span class="n">xprop</span> <span class="n">dut</span><span class="p">(</span>
              <span class="c1">// Outputs
</span><span class="c1"></span>              <span class="p">.</span><span class="n">out1</span>                     <span class="p">(</span><span class="n">out1</span><span class="p">),</span>
              <span class="c1">// Inputs
</span><span class="c1"></span>              <span class="p">.</span><span class="n">clk</span>                      <span class="p">(</span><span class="n">clk</span><span class="p">),</span>
              <span class="p">.</span><span class="n">sel</span>                      <span class="p">(</span><span class="n">sel</span><span class="p">),</span>
              <span class="p">.</span><span class="n">din0</span>                     <span class="p">(</span><span class="n">din0</span><span class="p">));</span>
<span class="k">endmodule</span>
</code></pre></td></tr></table>
</div>
</div>
<h3 id="模块连接">模块连接</h3>

<p>模块连接就是将硬件电路在测试平台进行例化，传统的verilog验证方法，在initial过程块产生激励，驱动硬件电路完成仿真。</p>

<hr />

<p><strong><em>文章原创，可能存在部分错误，欢迎指正，联系邮箱 cao_arvin@163.com。</em></strong></p>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">文辉</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
      2020-03-01
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content">文辉原创文章，如需转载请注明出处，谢谢！！！</span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://wenhui.space/tags/systemverilog/">SystemVerilog</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/about_emacs/emacs_folding_mode/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">emacs使用folding-mode</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/polular_science/rank_and_abbreviation/">
            <span class="next-text nav-default">你应该知道的职级与英文缩写</span>
            <span class="prev-text nav-mobile">下一篇</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  
  
  

  
  

  

  
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  


 
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2019 -
    2020
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        文辉
        
      </span></span>

  
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js" crossorigin="anonymous"></script>
  <script type="text/javascript" src="https://cdn.bootcss.com/slideout/1.0.1/slideout.min.js" crossorigin="anonymous"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>












  
    <script src="/js/load-photoswipe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe.min.js" integrity="sha256-UplRCs9v4KXVJvVY+p+RSo5Q4ilAUXh7kpjyIP5odyc="
      crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.1/photoswipe-ui-default.min.js" integrity="sha256-PWHOlUzc96pMc8ThwRIXPn8yH4NOLu42RQ0b9SpnpFk="
      crossorigin="anonymous"></script>
  















</body>
</html>
